SELECT First_name,last_name,email FROM customer;
SELECT DISTINCT(rating) FROM film;
SELECT COUNT(DISTINCT(rating)) FROM film;
SELECT COUNT(*) FROM film;
SELECT * FROM Customer WHERE first_name = 'Jared';
SELECT * FROM film WHERE rental_rate > 4 AND rental_rate < 4.5;
SELECT email FROM Customer WHERE first_name = 'Nancy' AND last_name = 'Thomas';
SELECT description FROM film WHERE title = 'Outlaw Hanky'; 
SELECT phone FROM address WHERE address = '259 Ipoh Drive';
SELECT * FROM Customer ORDER BY Customer_id ASC;
SELECT first_name,last_name FROM Customer ORDER BY store_id DESC,first_name ASC;
SELECT * FROM payment WHERE amount > 3 ORDER BY payment_date ASC LIMIT 10;
SELECT payment_date,
       customer_id,
	   amount 
	   FROM payment 
	   ORDER BY payment_date ASC 
	   LIMIT 10; 
SELECT title,length FROM film ORDER BY length ASC LIMIT 5;
SELECT COUNT(*) FROM film WHERE length <= 50 ;
SELECT COUNT(*) FROM payment WHERE amount BETWEEN 8 and 9 LIMIT 10 ;
SELECT * FROM payment WHERE Payment_date BETWEEN '2007-02-01' AND '2007-02-16';-- Includes all the payments untill 14 cause the timestamp goes up 00:00 hours and not 24:00 
SELECT COUNT(*) FROM payment WHERE Amount NOT IN(2.99,9.98);
SELECT * FROM Customer WHERE first_name ILIKE '_HER%'; 
SELECT COUNT(*) FROM payment WHERE AMOUNT > 5;
SELECT COUNT(*) FROM actor WHERE first_name ILIKE 'P%'; 
SELECT DISTINCT (district) FROM address ORDER BY district ASC; 
SELECT COUNT(*) FROM film WHERE rating = 'R' AND replacement_cost BETWEEN 5 AND 15; 
SELECT COUNT(*) FROM film WHERE title ILIKE '%Truman%';
SELECT MIN(replacement_cost),MAX(replacement_cost),COUNT(*),ROUND(AVG(replacement_cost),3),SUM(replacement_cost) FROM film; --Aggregate functions  
SELECT customer_id,staff_id,COUNT(amount) FROM payment GROUP BY customer_id,staff_id ORDER BY COUNT(amount) ASC ; 
SELECT DATE(payment_date) FROM payment; -- using the date function 
SELECT staff_id,COUNT(payment_id) FROM payment GROUP BY staff_id; 
SELECT rating,ROUND(AVG(replacement_cost),3) FROM film GROUP BY rating ORDER BY rating; 
SELECT customer_id,SUM(amount) FROM Payment GROUP BY customer_id ORDER BY SUM(amount) DESC LIMIT 5;
SELECT customer_id,COUNT(DISTINCT (payment_id)) FROM Payment GROUP BY customer_id HAVING COUNT(DISTINCT (payment_id)) >= 40 ORDER BY COUNT(DISTINCT (payment_id)) DESC; 
SELECT customer_id,SUM(amount) FROM payment WHERE staff_id = 2 GROUP BY customer_id HAVING SUM(amount) >= 110 ORDER BY SUM(amount) DESC; 
SELECT COUNT(*) FROM film WHERE title ILIKE 'J%'; 
SELECT first_name,last_name FROM customer
WHERE first_name LIKE 'E%'
AND address_id <500
ORDER BY customer_id DESC
LIMIT 1;

-- Queries using JOINS 

SELECT amount AS cash FROM payment; 
SELECT payment.customer_id,email FROM payment 
INNER JOIN Customer
ON payment.customer_id = customer.customer_id
GROUP BY payment.customer_id,email
ORDER BY payment.customer_id ASC; 
SELECT * FROM customer 
FULL OUTER JOIN payment
ON customer.customer_id = payment.customer_id
WHERE customer.customer_id IS null OR payment.payment_id IS null;
SELECT film.film_id,film.title,inventory_id 
FROM film
LEFT OUTER JOIN inventory
ON film.film_id = inventory.film_id
WHERE inventory.inventory_id IS NULL; -- LEFT OUTER JOIN / LEFT JOIN with WHERE clause 
SELECT film.film_id,film.title,inventory_id 
FROM film
RIGHT JOIN inventory
ON film.film_id = inventory.film_id;
SELECT customer.email 
FROM customer 
INNER JOIN address
ON address.address_id = customer.address_id
WHERE address.district = 'California';   
SELECT title,first_name,last_name FROM film
INNER JOIN film_actor
ON film.film_id = film_actor.film_id
INNER JOIN actor
ON actor.actor_id = film_actor.actor_id
WHERE actor.first_name = 'Nick' AND actor.last_name = 'Wahlberg'; 

-- Advanced SQL commands
SHOW ALL; --Shows all system parameters
SHOW TIMEZONE; 
SELECT NOW();-- Gives the timestamp info 
SELECT TIMEOFDAY(); --Timestamp in string
SELECT CURRENT_TIME; --Just time
SELECT CURRENT_DATE; --Just date
SELECT AGE(payment_date) 
FROM payment
ORDER BY age;
SELECT EXTRACT(YEAR FROM payment_date) 
FROM payment; 
SELECT TO_CHAR(Payment_date , 'MONTH - DY')
FROM Payment;
SELECT TO_CHAR(Payment_date , 'MONTH')
FROM Payment
GROUP BY TO_CHAR(Payment_date , 'MONTH');
SELECT COUNT(*)
FROM payment
WHERE TO_CHAR(Payment_date,'DAY') = 'MONDAY   ' ; -- full upper case day name (blank-padded to 9 chars)
SELECT ROUND(rental_rate/replacement_cost,2) * 100 AS Percentage
FROM Film
ORDER BY Percentage DESC; 
SELECT LENGTH(first_name),first_name 
FROM Customer
ORDER BY length DESC; 
SELECT upper(first_name) || ' ' || upper(last_name) AS Customer_full_name
FROM customer; 
SELECT substring(first_name from 1 for 1) || last_name || '@gmail.com' AS New_customer_email_id
FROM customer;
SELECT LOWER(LEFT(first_name,1) || last_name ||'@gmail.com') AS customer_new_email_id
FROM customer;  
SELECT title,rental_rate 
FROM film
WHERE rental_rate > (SELECT AVG(rental_rate) FROM film)
ORDER BY rental_rate ASC; 
SELECT * FROM rental
WHERE return_date BETWEEN '2005-05-29' AND '2005-05-30'; 
SELECT film_id,title
FROM film
WHERE film_id IN
(SELECT inventory.film_id
from rental
INNER JOIN inventory ON inventory.inventory_id = rental.inventory_id
WHERE return_date BETWEEN '2005-05-29' AND '2005-05-30')
ORDER BY film_id; 
SELECT first_name,last_name
FROM customer AS C
WHERE EXISTS
(SELECT * FROM payment AS P
WHERE p.customer_id = C.customer_id
AND amount > 11); 
SELECT tableA.length,tableA.title,tableB.title
FROM film AS tableA
JOIN film AS tableB 
ON tableA.length = tableB.length
AND tableA.title != tableb.title;
SELECT name,membercost 
FROM cd.facilities
WHERE membercost > 0; 
SELECT facid,name,membercost,monthlymaintenance
FROM cd.facilities
WHERE membercost != 0 AND membercost < (monthlymaintenance/50); 
SELECT *
FROM cd.facilities
WHERE name ILIKE '%Tennis%'; 
SELECT *
FROM cd.facilities
WHERE facid IN (1,5); 
SELECT DISTINCT(surname) 
FROM cd.members
ORDER BY surname
LIMIT 10; 
SELECT MAX(joindate)
FROM cd.members; 
SELECT count(*) FROM cd.facilities
WHERE guestcost >= 10; 
SELECT facid,SUM(slots) AS total_slots
FROM cd.bookings
GROUP BY facid
HAVING SUM(slots) > 1000
ORDER BY facid;
SELECT cd.bookings.starttime AS start, cd.facilities.name 
AS name 
FROM cd.facilities 
INNER JOIN cd.bookings
ON cd.facilities.facid = cd.bookings.facid 
WHERE cd.facilities.facid IN (0,1) 
AND cd.bookings.starttime >= '2012-09-21' 
AND cd.bookings.starttime < '2012-09-22' 
ORDER BY cd.bookings.starttime; 
SELECT firstname,surname,starttime
FROM cd.bookings 
INNER JOIN cd.members
ON cd.bookings.memid = cd.members.memid
WHERE firstname = 'David' AND
surname = 'Farrell';

SELECT CITY FROM STATION WHERE MOD(ID, 2) = 0;-- Printing columns with even id'd
